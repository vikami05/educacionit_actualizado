<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Certificado - .Net</title>

  <!-- Bootstrap y Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Estilos propios -->
  <link rel="stylesheet" href="{{ url_for('static', filename='Campus/Cursos/dotnet/certificado.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='Campus/Cursos/dotnet/campus.css') }}">
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-dark px-3">
    <span class="navbar-text text-white">Campus Educaci贸nIT</span>

    <div class="dropdown">
      <a class="d-flex align-items-center text-white text-decoration-none dropdown-toggle"
         href="#" id="dropdownUser" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-person-circle user-icon fs-4"></i>
        <span class="ms-2">{{ usuario.nombre if usuario else 'Usuario' }}</span>
      </a>

      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownUser">
        <li>
          <a class="dropdown-item" href="{{ url_for('inicio_campus') }}">
            <i class="bi bi-house-door me-2"></i>Inicio
          </a>
        </li>
        <li>
          <a class="dropdown-item" href="{{ url_for('mis_cursos') }}">
            <i class="bi bi-journal-text me-2"></i>Mis cursos
          </a>
        </li>
        <li>
          <a class="dropdown-item" href="{{ url_for('logout') }}">
            <i class="bi bi-box-arrow-right me-2"></i>Salir
          </a>
        </li>
      </ul>
    </div>
  </nav>

<div class="campus-container justify-content-center" style="padding: 50px;">
  <main class="content text-center">
    <h2>隆Felicidades! Has completado el curso de .Net</h2>
    <p class="mt-3">Ahora puedes obtener tu certificado y subir un proyecto guiado en PDF, que te ayudar谩 a mejorar tu perfil profesional en la bolsa de empleo de Educaci贸nIT.</p>
    
    <p class="mt-3 text-success fw-semibold">
     Recuerda que ya tienes acceso de por vida al curso de .Net, para que puedas practicar, repasar contenidos y seguir perfeccionando tus habilidades cuando quieras.
   </p>

    <div class="mt-4">
      <button id="btn-descargar" class="btn btn-success me-2">Descargar certificado</button>
      <button id="btn-volver-campus" class="btn btn-primary">Volver al Campus</button>
    </div>

    <div class="mt-4">
      <h5>Sube tu proyecto guiado (opcional)</h5>
      <input type="file" id="subirProyecto" accept=".pdf">
      <p class="text-muted mt-2">El archivo PDF ayudar谩 a destacar tu perfil profesional en futuras oportunidades laborales.</p>
    </div>
  </main>
</div>

<!-- Contenedor del confeti -->
<div id="confetti-container"></div>

<script src="certificado.js"></script>

<script>
// ============================================
// BOTONES
// ============================================

// Bot贸n "Volver al Campus"
document.getElementById('btn-volver-campus').onclick = () => {
  window.location.href = "{{ url_for('curso_net') }}";  // Redirige al campus .NET
};

// Bot贸n "Descargar Certificado"
document.getElementById('btn-descargar').onclick = async () => {
  try {
    const resp = await fetch('/api/mis_certificados');
    const data = await resp.json();

    console.log('Certificados encontrados:', data);

    if (data && data.certificados && data.certificados.length > 0) {
      const cert = data.certificados[0]; // tomar el 煤ltimo certificado emitido
      alert('Descarga iniciada.');
      // Abre el archivo del certificado en una nueva pesta帽a o inicia descarga
      window.open(`/${cert.url_pdf}`, '_blank');
    } else {
      alert('A煤n no tienes certificados generados.');
    }
  } catch (err) {
    console.error('Error al obtener certificados:', err);
    alert('Ocurri贸 un error al buscar tu certificado.');
  }
};

// ============================================
// CONFETI ANIMADO
// ============================================
function generarConfeti() {
  const container = document.createElement('div');
  container.id = 'confetti-container';
  document.body.appendChild(container);

  const colores = ['#f94144','#f3722c','#f9c74f','#90be6d','#577590','#43aa8b','#f9844a'];

  for (let i = 0; i < 100; i++) {
    const confetti = document.createElement('div');
    confetti.classList.add('confetti');
    confetti.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
    confetti.style.left = Math.random() * window.innerWidth + 'px';
    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
    confetti.style.width = confetti.style.height = (Math.random() * 8 + 5) + 'px';
    container.appendChild(confetti);

    // Eliminar despu茅s de caer
    setTimeout(() => confetti.remove(), 5000);
  }
}

window.onload = generarConfeti;
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>
